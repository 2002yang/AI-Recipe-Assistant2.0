# å‰ç«¯ç»„ä»¶è°ƒç”¨æµç¨‹è¯¦è§£

## ğŸ“ å‰ç«¯æ–‡ä»¶ç»“æ„æ ‘

```
frontend/src/
â”‚
â”œâ”€â”€ main.tsx                          ã€åº”ç”¨å…¥å£ã€‘
â”‚   â””â”€â”€ ReactDOM.createRoot(App)
â”‚
â”œâ”€â”€ App.tsx                           ã€æ ¹ç»„ä»¶ - çŠ¶æ€ç®¡ç†ä¸­å¿ƒã€‘
â”‚   â”œâ”€â”€ State: messages, conversationId, currentResponse, isLoading
â”‚   â”œâ”€â”€ Effect: åˆå§‹åŒ–å¯¹è¯
â”‚   â”œâ”€â”€ Handler: handleSendMessage
â”‚   â””â”€â”€ Render: ChatInterface + RecipeCard + NutritionPanel
â”‚
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ Chat/
â”‚   â”‚   â””â”€â”€ ChatInterface.tsx         ã€èŠå¤©ç•Œé¢ç»„ä»¶ã€‘
â”‚   â”‚       â””â”€â”€ Props: messages, isLoading, onSendMessage
â”‚   â”‚
â”‚   â”œâ”€â”€ RecipeCard/
â”‚   â”‚   â””â”€â”€ RecipeCard.tsx            ã€èœè°±å¡ç‰‡ç»„ä»¶ã€‘
â”‚   â”‚       â””â”€â”€ Props: match (RecipeMatch)
â”‚   â”‚
â”‚   â””â”€â”€ NutritionInfo/
â”‚       â””â”€â”€ NutritionPanel.tsx        ã€è¥å…»é¢æ¿ç»„ä»¶ã€‘
â”‚           â””â”€â”€ Props: nutrition
â”‚
â”œâ”€â”€ services/
â”‚   â””â”€â”€ api.ts                        ã€APIæœåŠ¡å±‚ã€‘
â”‚       â”œâ”€â”€ chatApi: sendMessage, createConversation, getHistory
â”‚       â”œâ”€â”€ recipeApi: getAllRecipes, getRecipe, searchByIngredients
â”‚       â””â”€â”€ nutritionApi: getRecipeNutrition, checkDietSuitability
â”‚
â””â”€â”€ types/
    â””â”€â”€ index.ts                      ã€TypeScriptç±»å‹å®šä¹‰ã€‘
        â”œâ”€â”€ Nutrition, Ingredient, Recipe
        â”œâ”€â”€ RecipeMatch, ChatMessage
        â””â”€â”€ ChatResponse
```

---

## ğŸ”„ å®Œæ•´æ•°æ®æµå›¾

### åœºæ™¯ï¼šç”¨æˆ·è¾“å…¥"æˆ‘æœ‰ç•ªèŒ„é¸¡è›‹"

```
ç”¨æˆ·è¾“å…¥
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. ChatInterface.tsx                    â”‚
â”‚    - textarea æ•è·è¾“å…¥                  â”‚
â”‚    - handleSubmit è§¦å‘                  â”‚
â”‚    - è°ƒç”¨ onSendMessage(input)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. App.tsx (çˆ¶ç»„ä»¶å›è°ƒ)                 â”‚
â”‚    - handleSendMessage æ‰§è¡Œ             â”‚
â”‚    - Step 1: æ›´æ–°æœ¬åœ°çŠ¶æ€               â”‚
â”‚      setMessages([...messages,          â”‚
â”‚        {role: 'user', content}])        â”‚
â”‚    - Step 2: è®¾ç½® loading çŠ¶æ€          â”‚
â”‚      setIsLoading(true)                 â”‚
â”‚    - Step 3: è°ƒç”¨ API                   â”‚
â”‚      chatApi.sendMessage(message, id)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. api.ts (æœåŠ¡å±‚)                      â”‚
â”‚    - axios.post('/api/chat/message',    â”‚
â”‚        {message, conversation_id})      â”‚
â”‚    - é€šè¿‡ Vite Proxy è½¬å‘åˆ°åç«¯         â”‚
â”‚      proxy: {                           â”‚
â”‚        '/api': 'http://localhost:9000'  â”‚
â”‚      }                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚ HTTP POST
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. åç«¯ API (ç«¯å£9000)                  â”‚
â”‚    POST /api/chat/message               â”‚
â”‚    - è§£ææ„å›¾                           â”‚
â”‚    - åŒ¹é…èœè°±                           â”‚
â”‚    - ç”Ÿæˆå›å¤                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚ JSON Response
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. api.ts (æ¥æ”¶å“åº”)                    â”‚
â”‚    return response.data                 â”‚
â”‚    (ChatResponse ç±»å‹)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚ Promise<ChatResponse>
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6. App.tsx (å¤„ç†å“åº”)                   â”‚
â”‚    - æˆåŠŸ:                              â”‚
â”‚      setMessages([...messages,          â”‚
â”‚        {role: 'assistant',              â”‚
â”‚         content: response.message}])    â”‚
â”‚      setCurrentResponse(response)       â”‚
â”‚    - å¤±è´¥:                              â”‚
â”‚      setMessages([...messages,          â”‚
â”‚        {role: 'assistant',              â”‚
â”‚         content: 'æŠ±æ­‰ï¼Œå‘ç”Ÿé”™è¯¯'}])     â”‚
â”‚    - æœ€å: setIsLoading(false)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 7. React é‡æ–°æ¸²æŸ“                        â”‚
â”‚    - ChatInterface: æ˜¾ç¤ºæ–°æ¶ˆæ¯          â”‚
â”‚    - RecipeCard: æ˜¾ç¤ºæ¨èèœè°±           â”‚
â”‚    (currentResponse.suggested_recipes)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ è¯¦ç»†ä»£ç æµç¨‹

### ç¬¬1æ­¥ï¼šç”¨æˆ·è¾“å…¥

**æ–‡ä»¶**: `ChatInterface.tsx`

```typescript
// ç”¨æˆ·è¾“å…¥"æˆ‘æœ‰ç•ªèŒ„é¸¡è›‹"
const [input, setInput] = useState('');

// è¾“å…¥æ¡†å˜åŒ–
<textarea
  value={input}
  onChange={handleInput}  // æ›´æ–° input çŠ¶æ€
  onKeyDown={handleKeyDown}  // Enter æäº¤
/>

// æäº¤å¤„ç†
const handleSubmit = (e: React.FormEvent) => {
  e.preventDefault();
  if (input.trim() && !isLoading) {
    onSendMessage(input);  // â­ è°ƒç”¨çˆ¶ç»„ä»¶ä¼ å…¥çš„å›è°ƒ
    setInput('');  // æ¸…ç©ºè¾“å…¥
  }
};
```

**å…³é”®**: `onSendMessage` æ˜¯ App.tsx é€šè¿‡ props ä¼ å…¥çš„å›è°ƒå‡½æ•°

---

### ç¬¬2æ­¥ï¼šå›è°ƒåˆ°çˆ¶ç»„ä»¶

**æ–‡ä»¶**: `App.tsx`

```typescript
// å®šä¹‰çŠ¶æ€
const [messages, setMessages] = useState<Array<{
  role: 'user' | 'assistant';
  content: string;
}>>([]);

const [conversationId, setConversationId] = useState<string>('');
const [currentResponse, setCurrentResponse] = useState<ChatResponse | null>(null);
const [isLoading, setIsLoading] = useState(false);

// å¤„ç†å‘é€æ¶ˆæ¯çš„å›è°ƒå‡½æ•°
const handleSendMessage = async (message: string) => {
  if (!message.trim() || !conversationId) return;

  // Step 1: ç«‹å³æ›´æ–° UI - æ˜¾ç¤ºç”¨æˆ·æ¶ˆæ¯
  setMessages((prev) => [
    ...prev,
    { role: 'user', content: message }
  ]);

  // Step 2: æ˜¾ç¤ºåŠ è½½çŠ¶æ€
  setIsLoading(true);

  try {
    // Step 3: è°ƒç”¨ API
    const response = await chatApi.sendMessage(message, conversationId);
    
    // Step 4: æ›´æ–° UI - æ˜¾ç¤ºåŠ©æ‰‹å›å¤
    setMessages((prev) => [
      ...prev,
      { role: 'assistant', content: response.message }
    ]);
    
    // Step 5: ä¿å­˜å®Œæ•´å“åº”ï¼ˆåŒ…å«èœè°±ä¿¡æ¯ï¼‰
    setCurrentResponse(response);
    
  } catch (error) {
    console.error('Error:', error);
    setMessages((prev) => [
      ...prev,
      { role: 'assistant', content: 'æŠ±æ­‰ï¼Œå‘ç”Ÿäº†é”™è¯¯ï¼Œè¯·ç¨åå†è¯•ã€‚' }
    ]);
  } finally {
    // Step 6: å…³é—­åŠ è½½çŠ¶æ€
    setIsLoading(false);
  }
};

// æ¸²æŸ“æ—¶ä¼ é€’å›è°ƒç»™å­ç»„ä»¶
<ChatInterface
  messages={messages}
  isLoading={isLoading}
  onSendMessage={handleSendMessage}  // â­ ä¼ é€’å›è°ƒ
/>
```

---

### ç¬¬3æ­¥ï¼šAPI æœåŠ¡å±‚è°ƒç”¨

**æ–‡ä»¶**: `api.ts`

```typescript
import axios from 'axios';

// API åŸºç¡€è·¯å¾„ï¼ˆé€šè¿‡ Vite proxy è½¬å‘ï¼‰
const API_BASE = '/api';

export const chatApi = {
  // å‘é€æ¶ˆæ¯ - è¢« App.tsx è°ƒç”¨
  sendMessage: async (
    message: string, 
    conversationId?: string
  ): Promise<ChatResponse> => {
    
    // axios POST è¯·æ±‚
    const response = await axios.post(
      `${API_BASE}/chat/message`,  // å®é™…è¯·æ±‚: POST http://localhost:5173/api/chat/message
      {
        message,              // è¯·æ±‚ä½“: ç”¨æˆ·è¾“å…¥
        conversation_id: conversationId  // è¯·æ±‚ä½“: å¯¹è¯ID
      }
    );
    
    // è¿”å›åç«¯å“åº”æ•°æ®
    return response.data;  // ChatResponse ç±»å‹
  },

  // åˆ›å»ºæ–°å¯¹è¯
  createConversation: async (): Promise<{
    conversation_id: string;
    message: string;
  }> => {
    const response = await axios.post(`${API_BASE}/chat/new`);
    return response.data;
  }
};
```

**Vite Proxy é…ç½®** (`vite.config.ts`):
```typescript
export default defineConfig({
  server: {
    port: 5173,
    proxy: {
      '/api': {
        target: 'http://localhost:9000',  // è½¬å‘åˆ°åç«¯
        changeOrigin: true,
      },
    },
  },
});
```

**è¯·æ±‚æµç¨‹**:
```
å‰ç«¯: http://localhost:5173/api/chat/message
            â†“ Vite Proxy
åç«¯: http://localhost:9000/api/chat/message
```

---

### ç¬¬4æ­¥ï¼šåç«¯å¤„ç†ï¼ˆç®€è¦ï¼‰

åç«¯æ¥æ”¶è¯·æ±‚å¹¶è¿”å›:
```json
{
  "message": "ä¸ºæ‚¨æ¨èä»¥ä¸‹èœè°±...",
  "conversation_id": "xxx",
  "suggested_recipes": [
    {
      "recipe": {
        "id": 1,
        "name": "ç•ªèŒ„ç‚’è›‹",
        "nutrition": {...},
        ...
      },
      "match_score": 0.33,
      "matched_ingredients": ["ç•ªèŒ„", "é¸¡è›‹"],
      "missing_ingredients": ["å¤§è‘±", "ç›"]
    }
  ],
  "detected_ingredients": ["ç•ªèŒ„", "é¸¡è›‹"]
}
```

---

### ç¬¬5æ­¥ï¼šå“åº”æ•°æ®å¤„ç†

**æ–‡ä»¶**: `App.tsx`

```typescript
// å‡è®¾åç«¯è¿”å›:
const response = {
  message: "ä¸ºæ‚¨æ¨èç•ªèŒ„ç‚’è›‹...",
  suggested_recipes: [
    {
      recipe: { id: 1, name: "ç•ªèŒ„ç‚’è›‹", ... },
      match_score: 0.33,
      matched_ingredients: ["ç•ªèŒ„", "é¸¡è›‹"],
      missing_ingredients: ["å¤§è‘±", "ç›"]
    }
  ]
};

// ä¿å­˜åˆ°çŠ¶æ€
setCurrentResponse(response);
```

---

### ç¬¬6æ­¥ï¼šæ¡ä»¶æ¸²æŸ“å­ç»„ä»¶

**æ–‡ä»¶**: `App.tsx`

```typescript
return (
  <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
    {/* å·¦ä¾§: èŠå¤©ç•Œé¢ - å§‹ç»ˆæ˜¾ç¤º */}
    <div className="lg:col-span-2">
      <ChatInterface
        messages={messages}
        isLoading={isLoading}
        onSendMessage={handleSendMessage}
      />
    </div>

    {/* å³ä¾§: æ¨èä¿¡æ¯ - æ¡ä»¶æ¸²æŸ“ */}
    <div className="space-y-6">
      
      {/* â­ æ¡ä»¶1: æœ‰æ¨èèœè°±æ‰æ˜¾ç¤º RecipeCard */}
      {currentResponse?.suggested_recipes && 
       currentResponse.suggested_recipes.length > 0 && (
        <div className="bg-white rounded-2xl shadow-lg">
          <h3>æ¨èèœè°±</h3>
          <div>
            {currentResponse.suggested_recipes.map((match, index) => (
              <RecipeCard key={index} match={match} />
            ))}
          </div>
        </div>
      )}

      {/* â­ æ¡ä»¶2: æœ‰è¥å…»ä¿¡æ¯æ‰æ˜¾ç¤º NutritionPanel */}
      {currentResponse?.nutrition_info && (
        <NutritionPanel nutrition={currentResponse.nutrition_info} />
      )}
      
    </div>
  </div>
);
```

**å…³é”®ç‚¹**:
- `currentResponse?.suggested_recipes` - å¯é€‰é“¾ï¼Œé˜²æ­¢ null æŠ¥é”™
- `&&` çŸ­è·¯è¿ç®— - åªæœ‰æ¡ä»¶ä¸ºçœŸæ‰æ¸²æŸ“
- `map()` éå† - å¤šä¸ªèœè°±å¡ç‰‡

---

### ç¬¬7æ­¥ï¼šå­ç»„ä»¶æ¸²æŸ“

**æ–‡ä»¶**: `RecipeCard.tsx`

```typescript
interface RecipeCardProps {
  match: RecipeMatch;  // ä»çˆ¶ç»„ä»¶ä¼ å…¥
}

export const RecipeCard: React.FC<RecipeCardProps> = ({ match }) => {
  // è§£æ„æ•°æ®
  const { recipe, match_score, matched_ingredients, missing_ingredients } = match;

  return (
    <div className="bg-gray-50 rounded-xl">
      {/* èœåå’ŒåŒ¹é…åº¦ */}
      <h4>{recipe.name}</h4>
      <div>{Math.round(match_score * 100)}%</div>
      
      {/* å·²æœ‰é£Ÿæ */}
      {matched_ingredients.length > 0 && (
        <div>
          <CheckCircle />
          <span>å·²æœ‰: {matched_ingredients.join('ã€')}</span>
        </div>
      )}
      
      {/* è¿˜éœ€é£Ÿæ */}
      {missing_ingredients.length > 0 && (
        <div>
          <XCircle />
          <span>è¿˜éœ€: {missing_ingredients.join('ã€')}</span>
        </div>
      )}
    </div>
  );
};
```

---

## ğŸ¯ æ•°æ®ä¼ é€’å…³ç³»å›¾

```
App.tsx (çˆ¶ç»„ä»¶ - æ•°æ®ç®¡ç†)
â”‚
â”œâ”€ State: messages â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                  â”‚
â”œâ”€ State: currentResponse â”€â”€â”€â”€â”€â”€â” â”‚
â”‚                                â”‚ â”‚
â”œâ”€ State: isLoading â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚                               â”‚ â”‚ â”‚
â””â”€ Callback: handleSendMessage  â”‚ â”‚ â”‚
    â”‚                           â”‚ â”‚ â”‚
    â–¼                           â”‚ â”‚ â”‚
ChatInterface.tsx               â”‚ â”‚ â”‚
â”‚                               â”‚ â”‚ â”‚
â”œâ”€ Props: messages (æ˜¾ç¤º) â—„â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”œâ”€ Props: isLoading (åŠ è½½çŠ¶æ€) â—„â”€â”€â”˜ â”‚
â””â”€ Props: onSendMessage (å›è°ƒ) â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
api.ts (axios è¯·æ±‚)
    â”‚
    â–¼
åç«¯ API (ç«¯å£9000)
    â”‚
    â–¼
è¿”å› ChatResponse
    â”‚
    â–¼
App.tsx (æ›´æ–° State)
    â”‚
    â”œâ”€ setMessages() æ›´æ–°èŠå¤©
    â””â”€ setCurrentResponse() æ›´æ–°æ¨è
        â”‚
        â–¼
æ¡ä»¶æ¸²æŸ“:
â”œâ”€ RecipeCard.tsx â—„â”€â”€ currentResponse.suggested_recipes
â””â”€ NutritionPanel.tsx â—„â”€â”€ currentResponse.nutrition_info
```

---

## ğŸ”‘ å…³é”®æŠ€æœ¯ç‚¹

### 1. Props ä¼ é€’ (çˆ¶å­é€šä¿¡)

```typescript
// çˆ¶ç»„ä»¶ App.tsx
<ChatInterface
  messages={messages}           // å‘ä¸‹ä¼ æ•°æ®
  isLoading={isLoading}         // å‘ä¸‹ä¼ çŠ¶æ€
  onSendMessage={handleSendMessage}  // å‘ä¸‹ä¼ å›è°ƒ
/>

// å­ç»„ä»¶ ChatInterface.tsx
interface ChatInterfaceProps {
  messages: Message[];          // æ¥æ”¶æ•°æ®
  isLoading: boolean;           // æ¥æ”¶çŠ¶æ€
  onSendMessage: (msg: string) => void;  // æ¥æ”¶å›è°ƒ
}
```

### 2. çŠ¶æ€æå‡ (State Lifting)

```typescript
// çŠ¶æ€å®šä¹‰åœ¨çˆ¶ç»„ä»¶
const [messages, setMessages] = useState([]);

// å­ç»„ä»¶é€šè¿‡å›è°ƒä¿®æ”¹çˆ¶ç»„ä»¶çŠ¶æ€
onSendMessage(input) 
  â†’ handleSendMessage (åœ¨çˆ¶ç»„ä»¶ä¸­)
    â†’ setMessages([...])  (ä¿®æ”¹çˆ¶ç»„ä»¶çŠ¶æ€)
      â†’ è‡ªåŠ¨é‡æ–°æ¸²æŸ“å­ç»„ä»¶
```

### 3. æ¡ä»¶æ¸²æŸ“

```typescript
// && çŸ­è·¯è¿ç®—
{condition && <Component />}

// ä¸‰å…ƒè¿ç®—
{condition ? <ComponentA /> : <ComponentB />}

// å®é™…åº”ç”¨
{currentResponse?.suggested_recipes?.length > 0 && (
  <RecipeCard />
)}
```

### 4. åˆ—è¡¨æ¸²æŸ“

```typescript
// map éå†æ•°ç»„
{array.map((item, index) => (
  <Component key={index} data={item} />
))}

// å®é™…åº”ç”¨
{messages.map((msg, idx) => (
  <div key={idx} className={msg.role}>
    {msg.content}
  </div>
))}
```

---

## ğŸ“Š å®Œæ•´çš„è¯·æ±‚-å“åº”ç”Ÿå‘½å‘¨æœŸ

```
æ—¶é—´ç‚¹    åŠ¨ä½œ                      ç»„ä»¶/æ–‡ä»¶
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
T+0ms     ç”¨æˆ·è¾“å…¥                  ChatInterface
          â†“
T+10ms    è§¦å‘ onSendMessage        ChatInterface
          â†“
T+20ms    æ‰§è¡Œ handleSendMessage    App.tsx
          - setMessages(ç”¨æˆ·æ¶ˆæ¯)
          - setIsLoading(true)
          â†“
T+30ms    è°ƒç”¨ chatApi.sendMessage  api.ts
          - axios.post('/api/chat/message')
          â†“
T+50ms    Vite Proxy è½¬å‘           vite.config.ts
          - '/api' â†’ 'http://localhost:9000'
          â†“
T+100ms   åç«¯æ¥æ”¶è¯·æ±‚              backend/chat.py
          - æ„å›¾è§£æ
          - èœè°±åŒ¹é…
          - ç”Ÿæˆå›å¤
          â†“
T+800ms   åç«¯è¿”å› JSON             backend
          â†“
T+810ms   axios æ¥æ”¶å“åº”            api.ts
          - return response.data
          â†“
T+820ms   å¤„ç†å“åº”                  App.tsx
          - setMessages(åŠ©æ‰‹å›å¤)
          - setCurrentResponse(data)
          - setIsLoading(false)
          â†“
T+830ms   React é‡æ–°æ¸²æŸ“            æ‰€æœ‰ç»„ä»¶
          - ChatInterface (æ–°æ¶ˆæ¯)
          - RecipeCard (æ–°æ¨è)
          â†“
T+840ms   ç”¨æˆ·çœ‹åˆ°ç»“æœ              æµè§ˆå™¨
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
```

---

## ğŸ’¡ æ€»ç»“

### æ•°æ®æµå‘å£è¯€

```
ç”¨æˆ·è¾“å…¥ â†’ å­ç»„ä»¶å›è°ƒ â†’ çˆ¶ç»„ä»¶å¤„ç† â†’ APIè¯·æ±‚
                                          â†“
æ˜¾ç¤ºç»“æœ â† å­ç»„ä»¶æ¸²æŸ“ â† çˆ¶ç»„ä»¶çŠ¶æ€ â† åç«¯å“åº”
```

### ç»„ä»¶èŒè´£

| ç»„ä»¶ | èŒè´£ | å…³é”®ä»£ç  |
|------|------|----------|
| **ChatInterface** | ç”¨æˆ·äº¤äº’ã€è¾“å…¥æ•è· | `onSendMessage(input)` |
| **App** | çŠ¶æ€ç®¡ç†ã€æ•°æ®æµè½¬ | `handleSendMessage()` |
| **api.ts** | HTTPè¯·æ±‚ã€æ•°æ®æ ¼å¼ | `axios.post(...)` |
| **RecipeCard** | å±•ç¤ºèœè°±ä¿¡æ¯ | æ¥æ”¶ `match` prop |

**æ ¸å¿ƒæ€æƒ³**: çŠ¶æ€é›†ä¸­åœ¨ Appï¼Œé€šè¿‡ props å‘ä¸‹ä¼ é€’ï¼Œé€šè¿‡å›è°ƒå‘ä¸Šé€šä¿¡ï¼